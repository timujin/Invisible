[gd_scene load_steps=5 format=2]

[ext_resource path="res://Assets/Player.png" type="Texture" id=1]

[sub_resource type="GDScript" id=1]
script/source = "extends KinematicBody2D

var speed = 400

func _process(delta):
	look_at(get_global_mouse_position())
	
	if Input.is_action_just_pressed(\"fire\"):
		if not $RayCast2D.is_colliding(): return
		get_tree().get_nodes_in_group(\"ShootLiner\")[0].display_line($RayCast2D.get_collision_point())
		if $RayCast2D.get_collider().is_in_group(\"enemies\"):
			$RayCast2D.get_collider().kill()
			
	if Input.is_action_just_pressed(\"activate\"):
		for door in get_tree().get_nodes_in_group(\"door_activator\"):
			if $Activator.overlaps_area(door):
				door.get_parent().switch()
			
	#	if not $RayCast2D.is_colliding(): return
	#	if $RayCast2D.get_collider().is_in_group(\"doors\") and position.distance_to($RayCast2D.get_collider().global_position()):
	#		$RayCast2D.get_collider().kill()

func _physics_process(delta):
	var move = Vector2()
	if Input.is_action_pressed(\"move_down\"):
		move += Vector2(0,1)
	if Input.is_action_pressed(\"move_up\"):
		move += Vector2(0,-1)
	if Input.is_action_pressed(\"move_left\"):
		move += Vector2(-1,0)
	if Input.is_action_pressed(\"move_right\"):
		move += Vector2(1,0)
	move = move * speed
	move_and_slide(move)
	
func kill():
	get_tree().quit()"

[sub_resource type="CircleShape2D" id=2]
radius = 19.0

[sub_resource type="RectangleShape2D" id=3]
extents = Vector2( 11.4853, 17.3979 )

[node name="Player" type="KinematicBody2D" groups=[
"player",
]]
script = SubResource( 1 )

[node name="Sprite" type="Sprite" parent="."]
position = Vector2( 6.60511, 2.34661e-014 )
rotation = 1.5708
scale = Vector2( 0.212819, 0.212819 )
texture = ExtResource( 1 )

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
shape = SubResource( 2 )

[node name="RayCast2D" type="RayCast2D" parent="."]
position = Vector2( 19.17, 0 )
enabled = true
cast_to = Vector2( 1000, 0 )
collision_mask = 14
collide_with_areas = true

[node name="Activator" type="Area2D" parent="."]
collision_layer = 0
collision_mask = 4

[node name="CollisionShape2D" type="CollisionShape2D" parent="Activator"]
position = Vector2( 32.075, 1.13204 )
shape = SubResource( 3 )
